// Generated by the fenrisulfr tools.  DO NOT EDIT!
package com.lz.game.game3.common.proto;
import cn.teaey.fenrisulfr.IDispatcher;
import cn.teaey.fenrisulfr.core.Fenrisulfr;
import cn.teaey.fenrisulfr.result.ErrorResult;
import cn.teaey.fenrisulfr.result.GameResult;
import cn.teaey.fenrisulfr.result.IResult;
import cn.teaey.fenrisulfr.result.NullResult;
import com.google.protobuf.MessageLite;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.jboss.netty.channel.Channel;

/**
 * @author Teaey
 */
public abstract class LogicLoginMoudleService implements IDispatcher<Fenrisulfr.TransPacket>
{
    private static final Logger log = LoggerFactory.getLogger(LogicLoginMoudleService.class);
    @Override
    public void diapatch(Channel channel, Fenrisulfr.TransPacket packet)
    {
        int opcode = packet.getOpcode();
        try
        {
            IResult result = null;
            switch (opcode)
            {
                case LogicLoginOpcode.CP_Login:
                    result = CP_Login(Logic2Login1.CP_Login.parseFrom(packet.getContent()));
                    break;
                default:
                    log.warn("unknow opcode:{}", opcode);
                    break;
            }
            
            Fenrisulfr.TransPacket response = null;
            if (null != result)
            {
                if (result instanceof NullResult)
                {
                    return;
                }
                else if (result instanceof GameResult)
                {
                    MessageLite lite = (MessageLite) result.getResult();
                    response = Fenrisulfr.TransPacket.newBuilder(packet).setContent(lite.toByteString()).build();
                }
                else if (result instanceof ErrorResult)
                {
                    int responseCode = (int) result.getResult();
                    response = Fenrisulfr.TransPacket.newBuilder().setCounter(packet.getCounter()).setResponseCode(responseCode).build();
                }
                else
                {
                    log.error("unknow result type:{}", result.getClass());
                }
            }
            
            if (null != response)
            {
                channel.write(response);
            }
        } catch (Exception e)
        {
            log.error("", e);
        }
    }
    public abstract IResult CP_Login(Logic2Login1.CP_Login packet);
    
}
